<!DOCTYPE html>
<meta charset="utf-8">
<style>

.bar {
  float: left;
  width: 30px;
  margin-right: 20px;
  background-color: #F4F5F7;
  border: 1px solid #C5C5C5;
}
</style>

<script src="//d3js.org/d3.v3.min.js"></script>
<div id="chart">
  <div class="bar"></div>
  <div class="bar"></div>
  <div class="bar"></div>
  <div class="bar"></div>
</div>


<script>
  // Select all .bar children
  var selection = d3.select("#chart").selectAll(".bar");
  selection.style("height", "40px");

  
  //select all bars within the bar chart
  //selection.data(numbers);
/*  
  d3.select("#chart").selectAll(".bar").data(numbers)
    .style("height", function(d) {
	    return d + "px";
    });
*/


  
  function init() {
    var numbers = [15, 8, 42, 4];

    // Update selection: Resize and position existing 
    // DOM elements with data bound to them.
    
    var selection = d3.select("#chart").selectAll(".bar").data(numbers)
	              .style("height", function(d) {
			      return d + "px";
		       })
                      .style("margin-top", function(d) {
			      return (100 -d) + "px";
		       });


  }
  init();

  /*
  function update() {
    var numbers = [15, 8, 42, 4, 32];
    var selection = d3.select("#chart")
	              .selectAll(".bar").data(numbers);

    // Enter selection: Create new DOM elements for added 
    // data items, resize and position them.
    // 총 5개의 element중에 추가된 1개만 enter()를 통해서 넘어간다. 
    // d3 내부에서 중복되는것은 제거한다는 의미인가? 
    // https://medium.com/@c_behrens/enter-update-exit-6cafc6014c36#.ereylck1l
    // 
    selection.enter()
	     .append("div").attr("class", "bar")
	     .style("height", function(d) {
		     return d + "px";
	     })
             .style("margin-top", function(d) {
		     return (100 -d) + "px";
	     });
  }
  update();
  */

  function exit() {
    var numbers = [15, 8, 42, 4, 32];
    var selection = d3.select("#chart")
	              .selectAll(".bar").data(numbers);

    selection.enter()
	     .append("div").attr("class", "bar")
	     .style("height", function(d) {
		     return d + "px";
	     })
             .style("margin-top", function(d) {
		     return (100 -d) + "px";
	     })
	     .on("click", function(e, i) {
		     numbers.splice(i, 1);
		     exit();
	
	     });

    selection.exit().remove();

  }
  exit();
</script>

